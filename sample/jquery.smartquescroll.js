// Generated by CoffeeScript 1.7.1
(function() {
  var MobilePage, Page,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  MobilePage = (function() {
    function MobilePage(el, options) {
      this.el = el;
      this.options = options;
      this.touchend = __bind(this.touchend, this);
      this.touchmove = __bind(this.touchmove, this);
      this.touchstart = __bind(this.touchstart, this);
      this.touch = false;
      this.model = {
        y: 0
      };
      this.move();
      this.prev_y = 0;
      this.el.on('touchstart', this.touchstart);
      this.el.on('touchmove', this.touchmove);
      this.el.on('touchend', this.touchend);
    }

    MobilePage.prototype.touchstart = function(e) {
      if (this.touch) {
        return;
      }
      this.prev_y = this.get_y(e);
      return this.touch = true;
    };

    MobilePage.prototype.touchmove = function(e) {
      var now_y, _base;
      if (typeof (_base = this.options).scroll === "function") {
        _base.scroll(0, e);
      }
      now_y = this.get_y(e);
      this.model.y += now_y - this.prev_y;
      this.prev_y = now_y;
      return this.move();
    };

    MobilePage.prototype.touchend = function() {
      return this.touch = false;
    };

    MobilePage.prototype.move = function() {
      if (this.model.y > 0) {
        this.model.y = 0;
      }
      return this.translate(0, this.model.y);
    };

    MobilePage.prototype.translate = function(x, y) {
      return this.el.css({
        'transform': "translate  (" + x + "px, " + y + "px)",
        '-webkit-transform': "translate3d(" + x + "px, " + y + "px, 0px)",
        '-ms-transform': "translate  (" + x + "px, " + y + "px)"
      });
    };

    MobilePage.prototype.get_y = function(e) {
      return e.originalEvent.touches[0].pageY;
    };

    return MobilePage;

  })();

  Page = (function() {
    function Page(el, options) {
      this.el = el;
      this.options = options;
      this.wrapper = this.el.parent();
      this.wrapper.css('overflow', 'scroll');
      this.wrapper.on('scroll', (function(_this) {
        return function(e) {
          var _base;
          return typeof (_base = _this.options).scroll === "function" ? _base.scroll(_this.wrapper.scrollTop(), e) : void 0;
        };
      })(this));
    }

    return Page;

  })();

  (function($) {
    return $.fn.smartquescroll = function(options) {
      options = $.extend({
        scroll: null
      }, options);
      this.each(function() {
        if (navigator.userAgent.match(/iPhone|iPad|iPod|Android/)) {
          return new MobilePage($(this), options);
        } else {
          return new Page($(this), options);
        }
      });
      return this;
    };
  })(jQuery);

}).call(this);
